# Torrent4.0

## 概要（簡易プロジェクト憲章）
- Program: Torrent4.0_Development
- Project: Torrent4.0
- 参加者: 開発チーム
- 期間: 2025-10-01 → 2025-12-31

### 背景
製造業企業のデータ活用の非効率性、PDCAサイクルの手動管理による業務効率の低下。企業に転がっているデータを有効活用できていない現状を解決する必要がある。

#### 中小企業を取り巻く環境（2018年以降のDX化推進）
- **大手企業のDX化必須化**: 大手企業は既にDX取り組みが必須となり、取引先の中小企業にもデジタル対応を求めるケースが増加
- **サプライチェーン全体のDX化**: 受発注システム化など、サプライチェーン全体でのDX化が不可避
- **国・自治体の後押し**: IT導入補助金、支援制度の整備により中小企業のDX化が推進
- **DX未対応企業への圧力**: ITサービス未使用企業は採用・取引・業務効率で不利になる状況
- **ITスキルを持つ人材の増加**: プログラミング教育の普及により、ITスキルを持つ若年層が増加

### 目的（現時点の仮説）
目標管理のPDCAサイクルをAIで効率化・高度化し、製造業の営業担当者および現場作業員の業務効率を向上させる。企業に転がっているデータを引っ張り出し、AIとかけ合わせて、会計や生産管理などのいろんな文脈で便利に使える統合型システムを構築する。

### アプリ/サービス概要
- 種類: 自動目標管理SaaS（torrent統合基盤）
- メインユーザー: 中小企業（製造業企業をパイロットユーザー）
- 一言サマリ: 蓄積した業務データを目標管理に活用したいが、資金や人手、知見の不足により進められない中小企業向けの自動目標管理SaaS

### システム構成
Torrent4.0は大きく以下の2要素で構成される：

1. **統合基盤（torrent統合基盤）**
   - 組織のメンバーが利用する目標管理の統合基盤
   - 他サービスからのデータ取り込みにより自動的にデータ収集・進捗管理
   - 収集したデータを基に自動的に分析やサポートを実行
   - 管理に手間をかけずにデータの最新化を実現

2. **業務サービス群（torrentサービス）**
   - Torrentフレームワークを用いた業務サービスグループ
   - 営業支援、生産管理、販売管理など
   - マーケットプレイス形式で利用開始・停止が可能

### システムアーキテクチャ（2025年1月15日更新）

#### 5レイヤアーキテクチャ
Torrent4.0は以下の5つのレイヤで構成されるマルチテナント・マイクロサービスアーキテクチャを採用：

1. **[Presentation] プレゼンテーション層**
   - **マイクロフロントエンド**: 見積/受注/出荷/在庫/計画/実績などの業務別UI
   - **共通デザインシステム**: i18n（国際化）、A11y（アクセシビリティ）対応
   - **BFF per Domain**: GraphQL/REST API、認可・集約・キャッシュ機能

2. **[Domain Templates] ドメインテンプレート層**
   - **ms-quote-core**: 見積コアサービス + バーティカルパック（金属加工、食品加工など）
   - **ms-order/ms-ship/ms-inventory**: 受注、出荷、在庫管理サービス
   - **ms-plan/ms-prod/ms-forecast**: 計画、生産、予測サービス
   - **database-per-service + Outbox**: サービスごとの独立DB、イベント発行の整合性確保

3. **[Platform] プラットフォーム層**
   - **Identity & Access**: SSO、RBAC/ABAC、テナント分離
   - **Tenant Manager & Billing**: テナント管理、課金機能
   - **Template/Plugin Registry**: テンプレート・プラグイン管理、互換性確保
   - **AppConfig**: 実行時動的設定管理、Feature Flag、MFE解決
   - **Event Bus**: Pub/Subモデル、スキーマバージョン管理
   - **Workflow Orchestrator**: BPMN/DMN、Step Functions、Temporal
   - **Canonical Data Model**: API・イベント規約定義
   - **Data Services**: 監査ログ、全文検索、DWH連携
   - **Observability**: ログ・メトリクス・トレース

4. **[Integration] インテグレーション層**
   - **外部SaaS/社内システム**: 会計、EDI、WMS、SFAなど
   - **Inbound API/Webhook/CDC**: 外部データ連携技術

5. **[Edge] エッジ層**
   - **Edge Agent**: 双方向同期、オフライン動作、ローカルUI、周辺機器連携
   - **デバイス連携**: OPC-UA、Modbus、ラベルプリンター、スキャナ、秤など

#### 業界別テンプレート（Vertical Pack）設計
- **6つのPack構成**: UI、Rule、Workflow、Data、Integration、Analytics
- **設定駆動開発**: JSON Schema/UI Schemaによる動的UI生成
- **動的切り替え**: テナント/業界単位での機能有効化
- **互換性管理**: Base機能は互換性維持、破壊的変更はバージョン分離

#### イベント駆動アーキテクチャ
- **Bounded Context**: ドメイン駆動設計による適切な境界設定
- **EDA**: サービス間の疎結合と非同期処理
- **Provider/SPI**: 共通機能の抽象化と実装切り替え
- **Outboxパターン**: データベーストランザクションとイベント発行の整合性確保

#### PoC検証対象の技術要素
- **業務テンプレート**: テンプレート間の疎結合連携（Event-Driven Architecture）
- **AIテンプレート生成**: メタモデル＋Few-shot/RAGによる自動生成
- **AI対話型カスタマイズ**: 自然言語要望のDSLパッチ化
- **データ統合自動化**: AI支援によるマッピング提案と名寄せ
- **AI進捗分析**: 目標達成度の自動分析とインサイト提示
- **AIグラフ生成**: 自然言語指示によるグラフ自動生成

### 技術基盤
- フレームワーク: Smallit社自社開発のTorrentフレームワーク
- AI統合: PDCAサイクルでのAI活用（Plan/Do/Check/Action）
- 対象領域: 営業管理、生産管理、会計管理、データ移行支援

#### 技術スタック（2025年1月15日更新）

##### フロントエンド
- **マイクロフロントエンド**: Module Federation等
- **共通デザインシステム**: Storybook等
- **UI Schema**: JSONFormsライブラリ
- **BFF**: GraphQL/REST API

##### バックエンド
- **マイクロサービス**: Spring Boot、Node.js等
- **イベント駆動**: Apache Kafka、Debezium
- **ワークフロー**: Flowable、Camunda、Temporal、Step Functions
- **データベース**: PostgreSQL（JSONB対応）、Amazon Redshift

##### インフラ・運用
- **コンテナ化**: Docker、Kubernetes
- **監視・観測**: Prometheus、Grafana等
- **CI/CD**: 継続的インテグレーション・デプロイ
- **セキュリティ**: SSO、RBAC/ABAC、暗号化通信

#### 技術的アプローチ
- **AI自然言語処理**: データ項目の自動識別と分類機能
- **データ連携自動化**: 複数テーブルの結合処理の自動化
- **対話型AI**: 各画面での直接的なAI質問機能
- **データ投げ込み機能**: ユーザーが任意のデータを投げて分析依頼

### Torrent4.0の特徴・強み

#### 自動データ収集・進捗管理
- 他サービスからのデータ取り込みにより自動的にデータ収集・進捗管理
- torrentサービスと併用することですぐにDX化を進められる
- 管理に手間をかけずにデータの最新化ができる

#### 自動分析・サポート
- 収集したデータを基に自動的に分析やサポートを実行
- 目標管理や経営判断に関するデータの可視化を自動化
- torrentサービスや他サービスからの自動データ収集および分析

#### 目標達成アクションプラン提案
- 目標達成へのアクションプランの自動提案機能
- データドリブン経営の実現
- エンゲージメント重視の経営支援

### 解決する課題（これまで）

#### 1. 蓄積した業務データを目標管理に活用したいが、資金や人手、知見の不足により進められない
- 中小企業のDXがすすまない
- リソース不足、知見不足、開発するには高額
- DXの推進が大事なのはわかっているが、どのように進めたらいいかわからない

#### 2. 従業員の手間をかけてのデータ収集や自力でのデータ分析
- 勘や思い付きによる経営判断
- 手作業でのデータ収集・分析に時間がかかる
- データの精度・信頼性が低い

#### 3. データ連携の複雑性と専門知識の必要性
- 複数テーブルの結合処理が複雑で専門知識が必要
- データ項目の自動識別が困難
- システム連携の設定が専門家でないと困難

#### 4. AI活用の敷居の高さ
- AI機能を使うために別途チャットボットを立ち上げる必要
- 各画面で直接AIに質問できない
- データを投げて分析を依頼する機能が不足

### 実現する価値（これから）

#### 1. torrentサービスと併用することですぐにDX化を進められる
- 他システムのデータも自動収集・分析
- 目標管理や経営判断に関するデータの可視化を自動化

#### 2. torrentサービスや他サービスからの自動データ収集および分析
- 目標達成へのアクションプランの自動提案機能
- データドリブン経営の実現

#### 3. AI活用の敷居を下げる直感的な操作
- 各画面で直接AIに質問できる機能
- データを投げて分析を依頼する簡単な操作
- 専門知識不要で誰でも使える状態の実現

#### 4. データ連携の自動化と複雑性の解決
- 複数テーブルの結合処理の自動化
- AI自然言語処理によるデータ項目の自動識別
- システム連携設定の簡素化

#### 5. 「DX時代を生き抜く、全ての企業にITを。」を掲げるSmallitだからこそ
- 次の10年、20年を生き抜くためのプロダクト提案ができる
- 自分自身が当事者として経験した知見と技術力があるからできる

### 統合基盤の主要機能（MVP）

#### コア機能
- **ダッシュボード**: 目標・進捗の可視化、グラフ表示（BI）、メンバー状況
- **目標設定**: ビジョン設定、階層目標設定、AI目標設定提案
- **進捗状況管理**: チェックイン、進捗推移グラフ、自動収集データ連携
- **レポート**: レポート定義（BI）、データ分析結果の可視化
- **データ収集**: 外部データ収集設定、メタデータ設定
- **システム管理**: ユーザー管理、ロール管理、体制管理、マスタデータ連携

#### AI機能の具体的な活用シーン
- **定期的な分析**: グラフ内容を自動的に分析し、分析結果を表示
- **対話型分析**: 各画面で直接AIに質問できる機能（チャットボットとは別）
- **データ投げ込み分析**: ユーザーがデータを投げて分析を依頼する機能
- **レポート自動生成**: 分析結果から自動的にレポートを生成

#### 技術的課題と解決方針
- **データ連携の複雑性**: 複数テーブルの結合が必要な場合の自動化
- **AI自然言語処理**: データ項目の自動識別と分類
- **ユーザビリティ**: 専門知識不要で誰でも使える状態の実現

#### 拡張機能（MVP対象外）
- 定期フィードバック、文書管理、お知らせ
- 運用監視、AI業務支援

### Torrentフレームワークを用いた業務サービス
- 標準業務をテンプレート化したサービスを用意し、ユーザーごとに自動構築
- Torrent-fwでスクラッチ開発したサービスを提供
- ユーザーのタイミングで利用開始・停止が可能
- 業務サービス群のラインナップは今後の検討課題

### 構造
- Flow 作業ルート: `Flow/2025/01-15/torrent4_development/`
- Stock ルート: `Stock/programs/Torrent4.0_Development/projects/Torrent4.0/documents/`

### 次のステップ
- `@01_ペルソナ作成` から開始
- 成果物は 12/13 の提出コマンドで自動収集・提出

### エレベーターピッチ
torrent統合基盤は、蓄積した業務データを目標管理に活用したいが、資金や人手、知見の不足により進められない中小企業向けの自動目標管理SaaSである。これはtorrentサービスと併用することですぐにDX化を進められ、他システムのデータも自動収集・分析し、目標管理や経営判断に関するデータの可視化を自動化することができる。従業員の手間をかけてのデータ収集や自力でのデータ分析と違って、torrentサービスや他サービスからの自動データ収集および分析、目標達成へのアクションプランの自動提案機能が備わっている。そして「DX時代を生き抜く、全ての企業にITを。」を掲げるSmallitだからこそ、次の10年、20年を生き抜くためのプロダクト提案ができる。

### まとめ
Torrent4.0は、中小企業のDX推進における資金・人手・知見不足の課題を解決し、自動目標管理SaaSとして「成果につながる形」でDXを推進します。

#### アーキテクチャの革新性（2025年1月15日更新）
- **5レイヤアーキテクチャ**: プレゼンテーション、ドメインテンプレート、プラットフォーム、インテグレーション、エッジの明確な分離
- **業界別テンプレート**: 6つのVertical Packによる柔軟なカスタマイズ
- **イベント駆動設計**: サービス間の疎結合と高いスケーラビリティ
- **設定駆動開発**: JSON Schema/UI Schemaによる動的UI生成
- **マルチテナント対応**: テナント分離と共通サービスの効率的な運用

#### 技術的優位性
- **マイクロサービス**: 独立した開発・デプロイ・スケーリング
- **Outboxパターン**: データ整合性とイベント配信の信頼性確保
- **ワークフローエンジン**: 複雑な業務プロセスの自動化
- **エッジ対応**: オフライン動作とローカルデバイス連携
- **AI統合**: PDCAサイクルでのAI活用と自動分析

### 最新の開発状況（2025年10月8日時点）

#### 現在の開発チームの現状
- **統合基盤（目標管理の機能）**: 現在モックを作っている段階、AIはパンタレー社と協働で進めている
- **業務テンプレート（マーケットプレイス）**: 未だ何を作っていくのか決まっていない状況、Kintoneのパワーアップバージョンのようなもの
- **フレームワーク**: 既存のSmallit Torrent4.0用フレームワークのバージョンアップも進めている

#### MVPに向けたインタビュー候補企業
1. **平野鉄工**（年商2億）: 社内はシステム化がほとんどされていなく、アナログがほとんど。全体をデジタル化。一気通貫でできるというところが刺さっている。
2. **B社**（年商で数十億）: 航空機向けの製造業、美品メーカー。三菱電機等に部品をおろしている。一部部署だけで使いたいニーズ。
3. **C社**（百何十億）: 食料品の製造業。キャベツをカットして加工して生産したり。社長と話している。PDCAの、CAのサイクルが動いていない状況。
4. **D社**（トヨタ系と取引）: 専務と会っている。全社導入は難しい。例えば、一部部署で使ってみて広げていく計画。

#### モニターユーザー選定
- **推奨**: 平野鉄工（エクセルから始める、業務がシンプルなはず）
- **モニタリングKPI**: スケジュール感の把握

#### 最新の開発進捗（Notion議事録より）
- **10月8日**: スプリント運用方針決定、進捗モニタリング・達成予測機能のタスク切り出し、可視化機能のエピック作成
- **10月7日**: AI×目標管理のユースケース具体化、モニターユーザーへのヒアリング予定、データ分析機能の要件整理
- **10月6日**: 平野鉄鋼との初回インタビュー調整、顧客向けデモ用モックアップ準備、AI機能の位置づけと実装方針整理

#### 技術的検討事項（会議トランスクリプトより）
- **AI機能の統合方法**: 各画面での直接的なAI質問機能の実装方法
- **データ連携の自動化**: 複数テーブル結合処理の自動化手法
- **ユーザビリティの向上**: 専門知識不要で誰でも使える状態の実現
- **データ投げ込み機能**: ユーザーが任意のデータを投げて分析依頼する機能

#### PoC計画の主要技術要素
- **業務テンプレート**: テンプレート間の疎結合連携、AIによる大量生成、対話型カスタマイズ
- **統合基盤**: 複数データソースの自動統合、AIによる進捗分析、インサイト提示、グラフ自動生成
- **技術スタック**: Dify（AI）、Metabase（グラフ）、MCP（接続）、Amazon Redshift（DWH）
- **検証KPI**: マッピング適合率≧85%、KPI検算誤差≦2%、正しいグラフ生成率≧80%

### 参考資料

#### 基本資料
- Notion議事録: Smallit社とのMTG議事録（DB04_議事録）
- 最新議事録: Smallit_torrent_開発管理定例（2025-10-08）
- ヒアリング記録: `/documents/02_課題定義/ヒアリング記録_2025-10-08.md`
- プロジェクト全体像: `/documents/02_課題定義/プロジェクト全体像_2025-10-08.md`
- PoC計画: `/documents/02_課題定義/PoC計画_2025-10-08.md`

#### アーキテクチャ設計資料（2025年1月15日追加）
- **システムアーキテクチャ概念図**: `/documents/assets/システムアーキテクチャ概念図_2025-01-15.md`
- **レイヤ＆コンポーネント全体像**: `/documents/assets/レイヤコンポーネント全体像_2025-01-15.md`
- **CSV詳細分析**: `/documents/assets/CSV詳細分析_2025-01-15.md`
- **アーキテクチャ分析**: `/documents/assets/アーキテクチャ分析_2025-01-15.md`
- **Excel設計資料**: `/documents/assets/Smallit_業務テンプレートアーキテクチャ.xlsx`
- **CSV設計資料**: 
  - `/documents/assets/全体像（レイヤ＆コンポーネント）.csv`
  - `/documents/assets/テンプレート&Vertical設計（中核）.csv`

#### 設計思想・技術要素
- **マルチテナント設計**: テナント分離と共通サービスの両立
- **イベント駆動アーキテクチャ**: Kafka + Debezium + Outboxパターン
- **マイクロサービス設計**: Bounded Context + サービスごとのDB分離
- **業界別テンプレート**: 6つのVertical Pack構成
- **設定駆動開発**: JSON Schema/UI Schemaによる動的UI生成

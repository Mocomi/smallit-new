3.1　テンプレートの単位と疎結合,,,,,,,,,,,,
,Bounded Context毎に独立サービス（例：ms-order）。各サービスは独自DBを持ち、公開APIとドメインイベントで外部と接続。,,,,,,,,,,,
,EDA（Event-Driven）: 例）OrderCreated → ms-shipが出荷指示を生成。ms-inventory未導入なら在庫プロバイダ=スタブで通過。,,,,,,,,,,,
,Provider/SPI: 受注→在庫チェックなどの“役割”をプロバイダIFに抽象化。実体は「本物サービス」or「スタブ」に差替え。,,,,,,,,,,,
,,,,,,,,,,,,
,,Bounded Context：ドメイン駆動設計で出てくる概念。,,,,,,,,,,
,,ドメインイベント：ドメイン内で発生するイベント,,,,,,,,,,
,,EDA：Event-Driven Architecture,,,,,,,,,,
,,SPI：Service Provider Interface,,,,,,,,,,
,,,役割IF（例：在庫確認）。実装を差し替えても契約は不変。,,,,,,,,,
,,,契約：利用できるイベントの種類、データ形式、データ送信の頻度、利用上の制限、およびデータ取り扱いに関する責任範囲など,,,,,,,,,
,,,,,,,,,,,,
,,■業務領域ごとに個別のサービスを作成し、公開APIとイベントで他のサービスと連携する,,,,,,,,,,
,,,,,,,,,,,,
,,スタブサービスは常に稼働していて、実サービスが有効化された際に差し替える,,,,,,,,,,
,,→フラグ制御とかでできないか（アンチパターンじゃないか）確認する★,,,,,,,,,,
,,,→ドメイン駆動設計的に結合度が高くなってしまう（境界の独立性が弱まる）,,,,,,,,,
,,,→呼び出し元が if/else で分岐するため、コードパスごとにテストが必要,,,,,,,,,
,,,→将来的にサービスが増えると、条件分岐が増殖してスパゲッティ化する恐れあり,,,,,,,,,
,,,,,,,,,,,,
,,,,,,,,,,,,
3.2 業種別テンプレート（Vertical Pack内包）,,,,,,,,,,,,
,ベース: ms-<domain>-core（共通API/イベント/CDM最小核）。,,,,,,,,,,,
,Pack（テナント/拠点単位で有効化）,,,,,,,,,,,
,1. UI Pack: JSON Schema / UI Schema パッチ（項目/レイアウト/バリデーション）,,,,,,,,,,,
,2. Rule Pack: 原価/見積/割当などサンドボックスFaaS/Wasmで差替え,,,,,,,,,,,
,3. Workflow Pack: 承認/分岐（BPMN/DMN/Step Functions）,,,,,,,,,,,
,4. Data Pack: custom_attributes(JSONB) と拡張テーブル,,,,,,,,,,,
,5. Integration Pack: CAD/CAM、HACCP/ロット、GS1/ラベル 等,,,,,,,,,,,
,6. Analytics Pack: DWHのMART/ビュー/ダッシュボード,,,,,,,,,,,
,有効化フロー: Template Registryでindustry_profileを宣言 → AppConfigに同期 → BFF/UI/サービスが解決して注入。,,,,,,,,,,,
,互換性: Base契約は後方互換。破壊変更はメジャー/新イベントで分岐。,,,,,,,,,,,
,,,,,,,,,,,,
,ベースサービス（core）に対して機能差分（Pack）を適用する仕様？,,,,,,,,,,,
,■元資料の考え方,,,,,,,,,,,
,金属加工会社,,,,,,,,食品加工会社,,,
,,,,,,,,,,,,
,,,,,,,,,,,,
,,,,,,,,,,,,
,,,,,,,,,,,,
,,,,,,,,,,,,
,,,,,,,,,,,,
,,,,,,,,,,,,
,,,,,,,,,,,,
,,,,,,,,,,,,
,,★業務テンプレートでは処理差分の外部管理は行わない,,,,,,,,,,
,,,,,,,,,,,,
,,,,,,,,,,,,
,UI Pack：項目やレイアウトに関する機能,,,,,,,,,,,
,,JSON Schema：JSONデータの構造を定義・検証するための仕様,,,,,,,,,,
,,,JSON内のデータ構造をJSON形式で記載しておくことで、APIで受信したJSONデータが想定したデータ構造になっているか検証できる。,,,,,,,,,
,,,,,,,,,,,,
,,,,,,,,,,,,
,,,,,,,,,,,,
,,,,,,,,,,,,
,,,,,,,,,,,,
,,,,,,,,,,,,
,,,,,,,,,,,,
,,,,,,,,,,,,
,,,,,,,,,,,,
,,,,,,,,,,,,
,,,,,,,,,,,,
,,,,,,,,,,,,
,,,,,,,,,,,,
,,,,,,,,,,,,
,,,,,,,,,,,,
,,,,,,,,,,,,
,,,,,,,,,,,,
,,UI Schema：項目やレイアウトの定義をJSONファイルとして記載することで画面を構築する,,,,,,,,,,
,,,ライブラリに「JSONForms」がある。,,,,,,,,,
,,,,,,,,,,,,
,,■画面構成とデータ構造をJSON化することで、設定駆動の構築ができる。,,,,,,,,,,
,,→これらでどこまでの制御ができるか調査する。★,,,,,,,,,,
,,画面項目も使用サービスによって変更するため、その辺も踏まえて検討する★,,,,,,,,,,
,,,【参考】JSONSchemaからフォーム構築,,,,,,,,,
,,,,,,,,,,,,
,Rule Pack：業務ルールに関する機能,,,,,,,,,,,
,,サンドボックスFaaS：セキュリティを強化したFaaSの一種。LambdaもサンドボックスFaaS。,,,,,,,,,,
,,Wasm：WebAssembly,,,,,,,,,,
,,,,,,,,,,,,
,,業種ごとに異なる業務ルールを差分として切り出したもの,,,,,,,,,,
,,業種や顧客ごとに異なる部分（原価計算、見積計算、割当ルールなど）をFaaSで実装することで必要に応じて差し替えられるようにする,,,,,,,,,,
,,,,,,,,,,,,
,,■元資料の考え方,,,,,,,,,,
,,,,,,,,,,,,
,,,,,,,,,,,,
,,,,,,,,,,,,
,,,,,,,,,,,,
,,,,,,,,,,,,
,,,,,,,,,,,,
,,,,,,,,,,,,
,,,,,,,,,,,,
,,,,,,,,,,,,
,,,,,,,,,,,,
,,,,,,,,,,,,
,,,,,,,,,,,,
,,,,,,,,,,,,
,,,,,,,,,,,,
,,,,,,,,,,,,
,,,,,,,,,,,,
,,★業務テンプレートでは処理差分の外部管理は行わない,,,,,,,,,,
,,,,,,,,,,,,
,,,,,,,,,,,,
,Workflow Pack: 承認/分岐,,,,,,,,,,,
,,承認フロー：BPMN（Business Process Model and Notation）、DMN（Decision Model and Notation）,,,,,,,,,,
,,システムワークフロー：Step Functions、Temporal,,,,,,,,,,
,,Durable Execution Solutions | Temporal,,,,,,,,,,
,,BPMN（業務プロセスモデリング表記法）とは｜概要と表記法を解説 - Kaizen Penguin,,,,,,,,,,
,,ビジネスの意思決定をモデリングできるDMN(DRD)を使って業務ロジックの設計をやる #Drools - Qiita,,,,,,,,,,
,,,,,,,,,,,,
,,■「人が行う承認などのワークフロー」と「システムの手続き的なワークフロー」が一緒になっている,,,,,,,,,,
,,,,,,,,,,,,
,,OneNoteから転記,,,,,,,,,,
,,,Open Source Business Automation | Activiti,,,,,,,,,
,,,Flowable: Intelligent Business Process & Workflow Automation,,,,,,,,,
,,,The Universal Process Orchestrator | Camunda,,,,,,,,,
,,,jBPM - Open Source Business Automation Toolkit - jBPM Business Automation Toolkit,,,,,,,,,FlowableかCamunda
,,,,,,,,,,,,
,,■元資料の考え方,,,,,,,,,,
,,,例）出荷承認,,,,,,,,,
,,,,金属加工：社内承認→外注確認→出荷指示,,,,,,,,
,,,,食品加工：品質確認→賞味期限チェック→出荷承認,,,,,,,,
,,,基本的な管理はRule Packと同じで、業種別・顧客別に承認フローがあり、これを切り替えて使用する。,,,,,,,,,
,,,,,,,,,,,,
,,世の中のおおよそのOSSはAPIでワークフローデータを取得できる,,,,,,,,,,
,,,,,,,,,,,,
,,,,,,,,,,,,
,Data Pack: custom_attributes(JSONB) と拡張テーブル,,,,,,,,,,,
,,custom_attributes(JSONB)：JSONB型でJSON形式でデータ格納できるカラムを用意する,,,,,,,,,,
,,■拡張テーブル：標準からの差分を別テーブルで用意する,,,,,,,,,,
,,★利用サービスによって表示・非表示が変わる項目はどこに保持する？本テーブル？拡張テーブル？,,,,,,,,,,
,,,,,,,,,,,,
,,,,,,,,,,,,
,,,,,,,,,,,,
,Integration Pack: CAD/CAM、HACCP/ロット、GS1/ラベル 等,,,,,,,,,,,
,,CAD：コンピューターを利用して製品を設計する,,,,,,,,,,
,,CAM：設計データに基づいて工作機械を制御する,,,,,,,,,,
,,HACCP：ハサップ。原材料の入荷から製品の出荷までの工程で、食中毒などの健康被害につながる「危害要因（ハザード）」を科学的に特定し、除去・低減させるための手法,,,,,,,,,,
,,GS1：バーコードの標準規格,,,,,,,,,,
,,,,,,,,,,,,
,,,,,,,,,,,,
,Analytics Pack: DWHのMART/ビュー/ダッシュボード,,,,,,,,,,,
,,分析機能に関するPack,,,,,,,,,,
,,,,,,,,,,,,
,,,,,,,,,,,,
,,,,,,,,,,,,
3.3 連携例（在庫未導入でも動く）,,,,,,,,,,,,
,QuoteAccepted → OrderCreated → ShipmentRequested（在庫はスタブ判定） → ラベル/配送連携でShipmentCompleted。,,,,,,,,,,,
,後からms-inventory導入：初期スナップショット→プロバイダをスタブ→本実装へ切替（無停止）。,,,,,,,,,,,